{% extends 'base.html.twig' %}
{% block title %}
{% if is_granted('ROLE_SUPER_ADMIN') %}
	{{ 'Ticket.List'|trans|raw }}
{% else %}
	{{ 'Ticket.YourList'|trans|raw }}
{% endif %}
{% endblock %}
{% block body %}
	<h1 class="mb-4">{{ 'Ticket.List'|trans|raw }}</h1>
	<div class="table-responsive-lg">
		<table class="table align-middle table-xs table-bordered table-hover">
			<thead>
				<tr>
					<th class="text-center">{{ 'Ticket.Id'|trans|raw }}</th>
					<th class="text-left">{{ 'Ticket.Ticket_status'|trans|raw }}</th>
					<th class="text-left">{{ 'Ticket.Priority'|trans|raw }}</th>
					<th class="text-left">{{ 'Ticket.Company_id'|trans|raw }}</th>
					<th class="text-left">{{ 'Ticket.Created_by_id'|trans|raw }}</th>
					<th class="text-left">{{ 'Ticket.Code_folder'|trans|raw }}</th>
					<th class="text-left">{{ 'Ticket.Subject'|trans|raw }}</th>
					<th class="text-left">{{ 'Ticket.Due_at'|trans|raw }}</th>
					<th class="text-left">{{ 'Ticket.Is_billable'|trans|raw }}</th>
					<th class="text-left">{{ 'Ticket.Created_at'|trans|raw }}</th>

					<th>{{ 'Global.Actions'|trans|raw }}</th>
				</tr>
			</thead>
			<tbody>
				{% for item in tickets %}
					<tr>
						<td class="text-center">{{ item.id }}</td>
						<td class="text-left">
							{% set st = item.ticketStatus ? item.ticketStatus.value : null %}
							<span class="badge bg-{{ ('Ticket.statusClass.' ~ st)|trans }}">
							    {{ st ? ('Ticket.status.' ~ st)|trans : '—' }}
							</span>
						</td>
						<td class="text-left">
							{{ item.priority ? ('Ticket.priority.' ~ item.priority)|trans : '—' }}
						</td>
						<td class="text-left">{{ item.companyId ? item.companyId.name : '—' }}</td>
						<td class="text-left">{{ item.createdById ? item.createdById.email : '—' }}</td>
						<td class="text-left">{{ item.codeFolder }}</td>
						<td class="text-left">{{ item.subject }}</td>
						<td class="text-left">{{ item.dueAt ? item.dueAt|date('d/m/Y H:i') : '—' }}</td>
						<td class="text-left">{{ item.isBillable ? 'Oui' : 'Non' }}</td>
						<td class="text-left">{{ item.createdAt ? item.createdAt|date('d/m/Y H:i') : '—' }}</td>
						<td>
							<a href="{{ path('app_ticket_show', {'id': item.id}) }}" class="btn btn-link text-decoration-none text-orange">{{ 'Btn.View'|trans|raw }}</a>
							<a href="{{ path('app_ticket_edit', {'id': item.id}) }}" class="btn btn-link text-decoration-none text-orange">{{ 'Btn.Edit'|trans|raw }}</a>
							{% include 'ticket/_delete_form.html.twig' with { 'ticket': item } %}
						</td>
					</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	<a href="{{ path('app_ticket_new') }}" class="btn btn-orange mt-3">{{ 'Btn.New'|trans|raw }}</a>
{% endblock %}
